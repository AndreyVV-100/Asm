.model tiny
.code

org 100h

MAX_BUF_SIZE = 228

END_OF_LINE = 0
NEWLINE = 0Ah

Start: 

    jmp CreateProgram

MyProgram:

    db 33, 104, 21, 117, 6, 3, 154, 67
    db 208, 18, 1, 104, 19, 154, 67, 112, 0, 153
    db 154, 67, 126, 0, 1, 110, 0, 93, 21, 58
    db 190, 3, 1, 214, 194, 93, 21, 14, 190, 2
    db 93, 21, 75, 10, 2, 117, 136, 234, 22, 142
    db 93, 1, 122, 190, 2, 26, 232, 13, 215, 191
    db 116, 174, 3, 134, 93, 1, 123, 10, 2, 26
    db 235, 233, 116, 154, 3, 134, 20, 130, 198, 198
    db 202, 230, 230, 202, 200, 72, 20, 140, 194, 210
    db 216, 202, 200, 72, 232, 208, 202, 226, 234, 210
    db 198, 214, 196, 228, 222, 238, 220, 204, 222, 240
    db 212, 234, 218, 224, 230, 222, 236, 202, 228, 232
    db 208, 202, 216, 194, 244, 242, 200, 222, 206, 27
    db 200, 0, 0, 0, 0, 0, 0, 0, 0, 0
    db 0, 0, 0, 0, 0, 0, 0, 0, 0, 0
    db 0, 0, 0, 0, 0, 0, 0, 0, 0, 0
    db 0, 0, 0, 0, 0, 0, 0, 0, 0, 0
    db 0, 0, 0, 0, 0, 0, 0, 0, 0, 0
    db 0, 0, 0, 0, 0, 0, 0, 0, 0, 0
    db 0, 0, 0, 0, 0, 0, 0, 0, 0, 0
    db 0, 0, 0, 0, 0, 0, 0, 0, 0, 0
    db 0, 0, 0, 0, 0, 0, 0, 0, 0, 0
    db 0, 0, 0, 0, 0, 0, 0, 0, 0, 0
    db 0, 0, 0, 0, 0, 0, 0, 0, 0, 0
    db 0, 0, 0, 0, 0, 0, 0, 0, 0, 0
    db 0, 0, 0, 0, 0, 0, 0, 0, 0, 0
    db 0, 0, 0, 0, 0, 0, 0, 0, 0, 0
    db 0, 0, 0, 0, 0, 0, 0, 0, 0, 0
    db 0, 0, 0, 0, 0, 0, 0, 0, 0, 0
    db 0, 0, 0, 0, 0, 0, 0, 0, 0, 0
    db 0, 0, 0, 0, 0, 0, 0, 0, 0, 0
    db 0, 0, 0, 0, 0, 0, 0, 0, 0, 0
    db 0, 0, 0, 0, 0, 0, 0, 0, 0, 0
    db 0, 0, 0, 0, 0, 0, 0, 0, 0, 0
    db 0, 0, 0, 0, 0, 0, 0, 0, 0, 0
    db 0, 0, 0, 0, 0, 0, 0, 0, 1, 200

    ; db 32

    ; mov ax, 4c00h
    ; int 21h

CreateProgram:

    lea bx, MyProgram
    dec bx
    mov ah, 80h

    WhileCreating:

        inc bx
        mov al, byte ptr cs:[bx]
        and al, 1
        shl al, 7

        shr byte ptr cs:[bx], 1
        or  byte ptr cs:[bx], ah
        mov ah, al

        cmp byte ptr cs:[bx], 228
        jne WhileCreating

    jmp MyProgram

end Start
